<!DOCTYPE html>
<html lang="en">
<head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<!-- <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:400,400i,700&display=swap" rel="stylesheet"> -->
<link href="https://fonts.googleapis.com/css?family=Nunito+Sans:600,600i,700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap" rel="stylesheet"> 

<link rel="stylesheet" href="/assets/css/tailwind.css">
<link rel="stylesheet" href="/assets/css/style.css">
<link rel="stylesheet" href="/assets/css/cards.css">
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100&display=swap" rel="stylesheet">
<title>Regression with Gradient Descent in Low-level Matlab</title>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-125808593-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125808593-1');
</script>



<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Regression with Gradient Descent in Low-level Matlab | recluze - Nauman (recluze) on Computing, Philosophy and More …</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Regression with Gradient Descent in Low-level Matlab" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Update: If you are interested in getting a running start to machine learning and deep learning, I have created a course that I&#39;m offering to my dedicated readers for just $9.99. Access it here on Udemy. If you are only here for Matlab, continue reading =] I just finished writing my first machine learning algorithm in Matlab. The algorithm is based on gradient descent search for estimating parameters of linear regression (but can be easily extended to quadratic or even higher-dimensional polynomials). It&#39;s fairly easy if you know the theory behind the model. So, first a very brief theory portion. This isn&#39;t a tutorial on statistics. Go read a book if you don&#39;t know about regression. Just to recall: Regression comes in when you want to estimate a response variable ($latex y$) given explanatory variables ($latex x_i$). The goal for linear regression is to come up with values for parameters ($latex \theta_i$) such that you get a &#39;best possible fit&#39; for each jth instance in the dataset of m instances: $latex y^j = \sum_{i=1}^m{\theta_i \times x_i^j}$ In matrix notation, that comes simply to: $latex Y = \theta^T X$ (For ease, we assume that $latex x_1$ is a vector of all 1s thus making $latex \theta_1$ the y-intercept). The idea of gradient descent is to come up with the best (locally) values of $latex \theta$. It does this by repeatedly updating the value of $latex \theta$ using the formula: $latex \theta_i = \theta_i - \alpha * \sum_{j=1}^m{(\theta^T X^j - Y^j) X_i^j}$ If you have no idea what this is or if you want to know this in-depth, read till the end. Here&#39;s the Matlab code for this whole procedure I wrote at first. Note the use of W for $latex \theta$: [sourcecode language=&quot;matlab&quot;] % Gradient descent algo for linear regression % author: Nauman (recluze@gmail.com) %set the data X=[1 1 1 1 1 1 1; 22 49 80 26 40 54 91]; Y=[20 24 42 22 23 26 55]; hold on; plot(X(2,:),Y, &#39;x&#39;); % set the actual values of W W = [5.775 0.474]&#39;; YAct = (W&#39; * X); % GRADIENT DESCENT W = zeros(2,1); % initialize W to all zeros m = size(X,2); % number of instances n = size(W,1); % number of parameters alpha = 0.000025; % gradient descent step size disp(&#39;Starting Weights:&#39;); W % 1) do the loop for W estimation using gradient descent ------------ for iter = 1 : 20 % let&#39;s just do 5 iterations for now ... not til convergence % for each iteration for i = 1 : n % looping for each parameter W(i) % find the derivative of J(W) for all instances sum_j = 0; for j = 1 : m hW_j = 0; for inner_i = 1 : n hW_j = hW_j + W(inner_i) * X(inner_i,j); end sum_j = sum_j + ( (hW_j - Y(j)) * X(i,j) ) ; end % calculate new value of W(i) W(i) = W(i) - alpha * sum_j; end % plot the thingy newY = (W&#39; * X); gColor = 0.05 * iter; plot(X(2,:),newY, &#39;Color&#39;, [0 gColor 0]); % end 1) ------------ end % output the final weights disp (&#39;Final calculated weights&#39;); W % output actual weights from formula in Red W = [5.775 0.474]&#39; plot(X(2,:),YAct, &#39;Color&#39;,[1 0 0]); % finish off hold off; [/sourcecode]" />
<meta property="og:description" content="Update: If you are interested in getting a running start to machine learning and deep learning, I have created a course that I&#39;m offering to my dedicated readers for just $9.99. Access it here on Udemy. If you are only here for Matlab, continue reading =] I just finished writing my first machine learning algorithm in Matlab. The algorithm is based on gradient descent search for estimating parameters of linear regression (but can be easily extended to quadratic or even higher-dimensional polynomials). It&#39;s fairly easy if you know the theory behind the model. So, first a very brief theory portion. This isn&#39;t a tutorial on statistics. Go read a book if you don&#39;t know about regression. Just to recall: Regression comes in when you want to estimate a response variable ($latex y$) given explanatory variables ($latex x_i$). The goal for linear regression is to come up with values for parameters ($latex \theta_i$) such that you get a &#39;best possible fit&#39; for each jth instance in the dataset of m instances: $latex y^j = \sum_{i=1}^m{\theta_i \times x_i^j}$ In matrix notation, that comes simply to: $latex Y = \theta^T X$ (For ease, we assume that $latex x_1$ is a vector of all 1s thus making $latex \theta_1$ the y-intercept). The idea of gradient descent is to come up with the best (locally) values of $latex \theta$. It does this by repeatedly updating the value of $latex \theta$ using the formula: $latex \theta_i = \theta_i - \alpha * \sum_{j=1}^m{(\theta^T X^j - Y^j) X_i^j}$ If you have no idea what this is or if you want to know this in-depth, read till the end. Here&#39;s the Matlab code for this whole procedure I wrote at first. Note the use of W for $latex \theta$: [sourcecode language=&quot;matlab&quot;] % Gradient descent algo for linear regression % author: Nauman (recluze@gmail.com) %set the data X=[1 1 1 1 1 1 1; 22 49 80 26 40 54 91]; Y=[20 24 42 22 23 26 55]; hold on; plot(X(2,:),Y, &#39;x&#39;); % set the actual values of W W = [5.775 0.474]&#39;; YAct = (W&#39; * X); % GRADIENT DESCENT W = zeros(2,1); % initialize W to all zeros m = size(X,2); % number of instances n = size(W,1); % number of parameters alpha = 0.000025; % gradient descent step size disp(&#39;Starting Weights:&#39;); W % 1) do the loop for W estimation using gradient descent ------------ for iter = 1 : 20 % let&#39;s just do 5 iterations for now ... not til convergence % for each iteration for i = 1 : n % looping for each parameter W(i) % find the derivative of J(W) for all instances sum_j = 0; for j = 1 : m hW_j = 0; for inner_i = 1 : n hW_j = hW_j + W(inner_i) * X(inner_i,j); end sum_j = sum_j + ( (hW_j - Y(j)) * X(i,j) ) ; end % calculate new value of W(i) W(i) = W(i) - alpha * sum_j; end % plot the thingy newY = (W&#39; * X); gColor = 0.05 * iter; plot(X(2,:),newY, &#39;Color&#39;, [0 gColor 0]); % end 1) ------------ end % output the final weights disp (&#39;Final calculated weights&#39;); W % output actual weights from formula in Red W = [5.775 0.474]&#39; plot(X(2,:),YAct, &#39;Color&#39;,[1 0 0]); % finish off hold off; [/sourcecode]" />
<meta property="og:site_name" content="recluze - Nauman (recluze) on Computing, Philosophy and More …" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2010-06-25T00:40:25+05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Regression with Gradient Descent in Low-level Matlab" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"Regression with Gradient Descent in Low-level Matlab","dateModified":"2010-06-25T00:40:25+05:00","datePublished":"2010-06-25T00:40:25+05:00","description":"Update: If you are interested in getting a running start to machine learning and deep learning, I have created a course that I&#39;m offering to my dedicated readers for just $9.99. Access it here on Udemy. If you are only here for Matlab, continue reading =] I just finished writing my first machine learning algorithm in Matlab. The algorithm is based on gradient descent search for estimating parameters of linear regression (but can be easily extended to quadratic or even higher-dimensional polynomials). It&#39;s fairly easy if you know the theory behind the model. So, first a very brief theory portion. This isn&#39;t a tutorial on statistics. Go read a book if you don&#39;t know about regression. Just to recall: Regression comes in when you want to estimate a response variable ($latex y$) given explanatory variables ($latex x_i$). The goal for linear regression is to come up with values for parameters ($latex \\theta_i$) such that you get a &#39;best possible fit&#39; for each jth instance in the dataset of m instances: $latex y^j = \\sum_{i=1}^m{\\theta_i \\times x_i^j}$ In matrix notation, that comes simply to: $latex Y = \\theta^T X$ (For ease, we assume that $latex x_1$ is a vector of all 1s thus making $latex \\theta_1$ the y-intercept). The idea of gradient descent is to come up with the best (locally) values of $latex \\theta$. It does this by repeatedly updating the value of $latex \\theta$ using the formula: $latex \\theta_i = \\theta_i - \\alpha * \\sum_{j=1}^m{(\\theta^T X^j - Y^j) X_i^j}$ If you have no idea what this is or if you want to know this in-depth, read till the end. Here&#39;s the Matlab code for this whole procedure I wrote at first. Note the use of W for $latex \\theta$: [sourcecode language=&quot;matlab&quot;] % Gradient descent algo for linear regression % author: Nauman (recluze@gmail.com) %set the data X=[1 1 1 1 1 1 1; 22 49 80 26 40 54 91]; Y=[20 24 42 22 23 26 55]; hold on; plot(X(2,:),Y, &#39;x&#39;); % set the actual values of W W = [5.775 0.474]&#39;; YAct = (W&#39; * X); % GRADIENT DESCENT W = zeros(2,1); % initialize W to all zeros m = size(X,2); % number of instances n = size(W,1); % number of parameters alpha = 0.000025; % gradient descent step size disp(&#39;Starting Weights:&#39;); W % 1) do the loop for W estimation using gradient descent ------------ for iter = 1 : 20 % let&#39;s just do 5 iterations for now ... not til convergence % for each iteration for i = 1 : n % looping for each parameter W(i) % find the derivative of J(W) for all instances sum_j = 0; for j = 1 : m hW_j = 0; for inner_i = 1 : n hW_j = hW_j + W(inner_i) * X(inner_i,j); end sum_j = sum_j + ( (hW_j - Y(j)) * X(i,j) ) ; end % calculate new value of W(i) W(i) = W(i) - alpha * sum_j; end % plot the thingy newY = (W&#39; * X); gColor = 0.05 * iter; plot(X(2,:),newY, &#39;Color&#39;, [0 gColor 0]); % end 1) ------------ end % output the final weights disp (&#39;Final calculated weights&#39;); W % output actual weights from formula in Red W = [5.775 0.474]&#39; plot(X(2,:),YAct, &#39;Color&#39;,[1 0 0]); % finish off hold off; [/sourcecode]","url":"/2010/06/25/regression-with-gradient-descent-in-low-level-matlab/","mainEntityOfPage":{"@type":"WebPage","@id":"/2010/06/25/regression-with-gradient-descent-in-low-level-matlab/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>
  <header class="texture-blue">
    <div class="container"><div class="navbar">
	<ul>
		
		<a href="/"><li  >Home</li></a>
		
		<a href="/about"><li  >About</li></a>
		
		<a href="/learn"><li  >Courses</li></a>
		
	</ul>
</div></div><div class="container">
	<h1>Regression with Gradient Descent in Low-level Matlab</h1>
	<h4 class="post-description"></h4>
	<div class="post-date" style="margin-top:20px">
		Published on Jun 25, 2010
	</div>
	<ul class="post-tags"><li>Articles</li><li>Geek stuff</li><li>Tutorials</li></ul>
</div>
</header>
  <main>
    <div class="container">
      <div class="post-container">
          <p><strong>Update:</strong> If you are interested in getting a running start to machine learning and deep learning, I have created a course that I'm offering to my dedicated readers for just $9.99. <a href="https://www.udemy.com/practical-deep-learning-with-keras/?couponCode=RECLYBLOG" target="_blank" rel="noopener">Access it here on Udemy</a>. If you are only here for Matlab, continue reading =]</p>
<p>I just finished writing my first machine learning algorithm in Matlab. The algorithm is based on gradient descent search for estimating parameters of linear regression (but can be easily extended to quadratic or even higher-dimensional polynomials). It's fairly easy if you know the theory behind the model. So, first a very brief theory portion. This isn't a tutorial on statistics. Go read a book if you don't know about regression.</p>
<p><!--more--></p>
<p>Just to recall: Regression comes in when you want to estimate a response variable ($latex y$) given explanatory variables ($latex x_i$). The goal for linear regression is to come up with values for <em>parameters</em> ($latex \theta_i$) such that you get a 'best possible fit' for each jth instance in the dataset of m instances:</p>
<p>$latex y^j = \sum_{i=1}^m{\theta_i \times x_i^j}$</p>
<p>In matrix notation, that comes simply to:</p>
<p>$latex Y = \theta^T X$</p>
<p>(For ease, we assume that $latex x_1$ is a vector of all 1s thus making $latex \theta_1$ the y-intercept).</p>
<p>The idea of gradient descent is to come up with the best (locally) values of $latex \theta$. It does this by repeatedly updating the value of $latex \theta$ using the formula:</p>
<p>$latex \theta_i = \theta_i - \alpha * \sum_{j=1}^m{(\theta^T X^j - Y^j) X_i^j}$</p>
<p>If you have no idea what this is or if you want to know this in-depth, read till the end.</p>
<p>Here's the Matlab code for this whole procedure I wrote at first. Note the use of W for $latex \theta$:</p>
<p>[sourcecode language="matlab"]<br />
% Gradient descent algo for linear regression<br />
% author: Nauman (recluze@gmail.com)</p>
<p>%set the data<br />
X=[1 1 1 1 1 1 1; 22 49 80 26 40 54 91];<br />
Y=[20 24 42 22 23 26 55];<br />
hold on;<br />
plot(X(2,:),Y, 'x');</p>
<p>% set the actual values of W<br />
W = [5.775 0.474]';<br />
YAct = (W' * X);</p>
<p>% GRADIENT DESCENT<br />
W = zeros(2,1);     % initialize W to all zeros<br />
m = size(X,2);      % number of instances<br />
n = size(W,1);      % number of parameters<br />
alpha = 0.000025;    % gradient descent step size</p>
<p>disp('Starting Weights:');<br />
W</p>
<p>% 1) do the loop for W estimation using gradient descent ------------<br />
for iter = 1 : 20 % let's just do 5 iterations for now ... not til convergence<br />
% for each iteration<br />
for i = 1 : n       % looping for each parameter W(i)<br />
    % find the derivative of J(W) for all instances<br />
    sum_j = 0;<br />
    for j = 1 : m<br />
        hW_j = 0;<br />
        for inner_i = 1 : n<br />
            hW_j = hW_j + W(inner_i) * X(inner_i,j);<br />
        end<br />
        sum_j = sum_j + ( (hW_j - Y(j)) * X(i,j) ) ;<br />
    end<br />
    % calculate new value of W(i)<br />
    W(i) = W(i) - alpha * sum_j;<br />
end<br />
% plot the thingy<br />
newY = (W' * X);<br />
gColor = 0.05 * iter;<br />
plot(X(2,:),newY, 'Color', [0 gColor 0]);</p>
<p>% end 1) ------------
  
end  
% output the final weights  
disp ('Final calculated weights');  
W  
% output actual weights from formula in Red W = [5.775 0.474]'  
plot(X(2,:),YAct, 'Color',[1 0 0]);  
% finish off  
hold off;  
[/sourcecode]

Then I figured that I was just doing loops and didn't really need the matrices. So, I went back and thought about the whole nested loop thing and replaced the loop portion with this:

[sourcecode language="matlab"]  
for i = 1 : n % looping for each parameter W(i)  
 % calculate new value of W(i)  
 W(i) = W(i) - alpha \* sum( ((W'\*X) - Y) .\* X(i,:) );  
end  
[/sourcecode]

Seems suspiciously like the original formula, doesn't it? Here's what the plot look like. The red line shows the linear regression line calculated from a closed-form formula and the other lines show estimations of $latex \theta$ with the darkest colored ones being the initial guess and lighter ones are successive guesses.

![](/assets/images/2010/06/grad-desc.jpg "Estimating regression parameters through gradient-descent")

And finally, as promised, here's where you can learn all about this stuff: [machine learning video lectures from Stanford](http://www.youtube.com/watch?v=UzxYlbK2c7E).

</p>

      </div>

        <!-- Configure Disqus --></div>
  </main><footer class="footer">
  <span class="text-muted"> recluze | No rights reserved.</span>
</footer>
</body>
</html>