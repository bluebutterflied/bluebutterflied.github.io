<!DOCTYPE html>
<html lang="en">
<head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<!-- <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:400,400i,700&display=swap" rel="stylesheet"> -->
<link href="https://fonts.googleapis.com/css?family=Nunito+Sans:600,600i,700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap" rel="stylesheet"> 

<link rel="stylesheet" href="/assets/css/tailwind.css">
<link rel="stylesheet" href="/assets/css/style.css">
<link rel="stylesheet" href="/assets/css/cards.css">
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100&display=swap" rel="stylesheet">
<title>Using Codesmith and .netTiers</title>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-125808593-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125808593-1');
</script>



<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Using Codesmith and .netTiers | recluze - Nauman (recluze) on Computing, Philosophy and More …</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Using Codesmith and .netTiers" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I recently came across Codesmith and .netTiers. It’s one of the best things to happen to me since i started working in VB.NET. You can view the details of what these two are in their sites. Here’s the gist:" />
<meta property="og:description" content="I recently came across Codesmith and .netTiers. It’s one of the best things to happen to me since i started working in VB.NET. You can view the details of what these two are in their sites. Here’s the gist:" />
<meta property="og:site_name" content="recluze - Nauman (recluze) on Computing, Philosophy and More …" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2006-06-21T05:30:22+05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Using Codesmith and .netTiers" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"Using Codesmith and .netTiers","dateModified":"2006-06-21T05:30:22+05:00","datePublished":"2006-06-21T05:30:22+05:00","description":"I recently came across Codesmith and .netTiers. It’s one of the best things to happen to me since i started working in VB.NET. You can view the details of what these two are in their sites. Here’s the gist:","url":"/2006/06/21/using-codesmith-and-nettiers/","mainEntityOfPage":{"@type":"WebPage","@id":"/2006/06/21/using-codesmith-and-nettiers/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>
  <header class="texture-blue">
    <div class="container"><div class="navbar">
	<ul>
		
		<a href="/"><li  >Home</li></a>
		
		<a href="/about"><li  >About</li></a>
		
		<a href="/learn"><li  >Courses</li></a>
		
	</ul>
</div></div><div class="container">
	<h1>Using Codesmith and .netTiers</h1>
	<h4 class="post-description"></h4>
	<div class="post-date" style="margin-top:20px">
		Published on Jun 21, 2006
	</div>
	<ul class="post-tags"><li>Tutorials</li><li>VB.net</li></ul>
</div>
</header>
  <main>
    <div class="container">
      <div class="post-container">
          <p>I recently came across Codesmith and .netTiers. It’s one of the best things to happen to me since i started working in VB.NET. You can view the details of what these two are in their sites. Here’s the gist:</p>

<p>Codesmith is an engine for creating code dynamically based on templates. It saves time. .netTiers is a template for Codesmith which creates code for handling SQL Server databases. It creates classes for performing DML (and other operations) on all database tables. This is done by creating collections. You can use it as simply as a collection!</p>

<p>Now, the <a href="http://www.codeproject.com/showcase/CodeSmith.asp">tutorial</a> I tried to learn from - their official one - is incomplete! Put simply, it doesn’t work. So, I decided to write my own.<!--more--></p>

<p><strong>Tutorial</strong></p>

<ul>
  <li>Download <a href="http://www.codesmithtools.com/">Codesmith</a> trial and <a href="http://www.nettiers.com/">.netTiers</a>. Install them!</li>
  <li>Open <em>Codesmith Explorer</em> from the start menu.</li>
  <li>Click on <em>Open Folder</em> button in the toolbar and navigate to the <em>Templates</em> folder in the location where you installed .netTiers.</li>
  <li>Right-click on <em>netTiers.cst</em> file and <em>Execute</em>.</li>
</ul>

<p><img src="/assets/images/2006/06/1.gif" alt="" /></p>

<ul>
  <li>Select the database (refer to the screenshot below).</li>
  <li>Set <em>Entire Database</em> to true.</li>
  <li>Select <em>Output Directory</em>.</li>
  <li>Set a namespace name.</li>
  <li><em>Generate</em>!</li>
</ul>

<p><img src="/assets/images/2006/06/2.gif" alt="" /></p>

<ul>
  <li>If all goes well, you’ll have a new solution in the folder you selected as output directory. Open the solution. You’ll see that it has three projects. All three set to produce DLLs.</li>
  <li>Now add another project to the solution. This can be a C# or a Vb.NET project. I’m using VB.NET. I’ve named it <em>NorthwindFront</em>.</li>
  <li>Add a new item to the project. Select <em>Application Configuration File</em> as the type. It’s called App.conf by default. Leave it as it is.</li>
  <li>Open Enterprise Library Configuration from .netTiers program folder in the start menu.</li>
  <li>Click on Open File and select the App.Conf you just created.</li>
  <li>Right-click on <em>Application</em> and click <em>netTiers Block</em> from <em>New</em> submenu.</li>
  <li>Set these properties. (See screenshot for reference.)</li>
  <li>.nettiers Application block &gt; data providers &gt; sql data provider instance &gt; DataBase instance: Database instance (select from drop down)</li>
  <li>.nettiers Application block &gt; cache manager : cache manager (select from drop down)</li>
  <li>DataAccess application block &gt; connection strings &gt; sql connection string &gt; database &gt; value : [name of database] I used Northwind</li>
  <li>DataAccess application block &gt; connection strings &gt; sql connection string &gt; server &gt; value : [name of sql server machine] I used (local)</li>
  <li>Save the file. If there’s an error, restart. If it still doesn’t work, post a comment and tell me what it says!</li>
</ul>

<p><img src="/assets/images/2006/06/3.gif" alt="" /></p>

<ul>
  <li>This generates some *.conf files in your project directory. Go there and copy all of the *.conf files to your <em>bin</em> directory.</li>
  <li>That concludes the netTiers part of the tutorial. That’s all you need to do to set netTiers up. Now, you need to see how to use it.</li>
</ul>

<p>Here’s a project I created while learning to put this netTiers to use. It’s pretty basic but does all three DML operations. To run it, you need to have SQL server running on <strong>(local)</strong> with the default Northwind database using Integrated Security for login. To change these settings, see the last section of this tutorial.</p>

<p><a href="http://recluzepage.googlepages.com/NetTiersTest.rar">Download Project</a>.</p>

<p>Run this project and try these tasks:</p>

<p><strong>View</strong> the list of Employees. Try typing a name in the text box to see dynamic searching in action. You can also use up, down, page-up and page-down keys in the textbox for navigation.</p>

<p><strong>Enter</strong> new employees. (Just enter the values and click on Add.)</p>

<p><strong>Modify</strong> past records. This is the most functional part. You can enter an ID in the ID field and hit enter to load that record in the boxes below. If that ID doesn’t exist, you’re shown the view box in which you can select an employee and hit enter to load that.<br />
<strong>Changing SQL server database and server</strong></p>

<p>If you want to change these settings, open up the <em>DataConfiguration.conf</em> file from your <em>bin</em> folder and edit the settings. (See screenshot.)</p>

<p><img src="/assets/images/2006/06/4.gif" alt="" /></p>

<p>If you download the project and try running it, you’ll notice that it doesn’t work! This is because of the way references are created by netTiers. Here’s what you need to do to fix it. I know this isn’t the right solution. I’m trying to get to do this properly. If you find something, do leave me a note.</p>

<ul>
  <li>Open the solution. Open the Properties of the Northwind.DataAccessLayer project.</li>
  <li>In the <em>References Path</em> section of <em>Common Properties</em>, change the path to [$YourSolutionPath]/References.</li>
  <li>Do the same for Northwind.DataAccessLayer.SqlClient project.</li>
  <li>Compile/run the project.</li>
</ul>

<p>If you find something wrong and/or missing in this tutorial, please let me know.</p>


      </div>

        <!-- Configure Disqus --></div>
  </main><footer class="footer">
  <span class="text-muted"> recluze | No rights reserved.</span>
</footer>
</body>
</html>