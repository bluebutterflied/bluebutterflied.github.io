<!DOCTYPE html>
<html lang="en">
<head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<!-- <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:400,400i,700&display=swap" rel="stylesheet"> -->
<link href="https://fonts.googleapis.com/css?family=Nunito+Sans:600,600i,700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap" rel="stylesheet"> 

<link rel="stylesheet" href="/assets/css/tailwind.css">
<link rel="stylesheet" href="/assets/css/style.css">
<link rel="stylesheet" href="/assets/css/cards.css">
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100&display=swap" rel="stylesheet">
<title>Creating a dApp (Smart Contract) on Ethereum</title>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-125808593-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125808593-1');
</script>



<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Creating a dApp (Smart Contract) on Ethereum | recluze - Nauman (recluze) on Computing, Philosophy and More …</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Creating a dApp (Smart Contract) on Ethereum" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I recently created a video course on creating a dApp on top of the Ethereum framework. Along with the detailed videos, I prepared step-by-step notes for the course. So, I decided to share them here for those who wish to learn from text-based material instead." />
<meta property="og:description" content="I recently created a video course on creating a dApp on top of the Ethereum framework. Along with the detailed videos, I prepared step-by-step notes for the course. So, I decided to share them here for those who wish to learn from text-based material instead." />
<meta property="og:site_name" content="recluze - Nauman (recluze) on Computing, Philosophy and More …" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-10-13T12:14:00+05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Creating a dApp (Smart Contract) on Ethereum" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"Creating a dApp (Smart Contract) on Ethereum","dateModified":"2021-10-13T12:14:00+05:00","datePublished":"2021-10-13T12:14:00+05:00","description":"I recently created a video course on creating a dApp on top of the Ethereum framework. Along with the detailed videos, I prepared step-by-step notes for the course. So, I decided to share them here for those who wish to learn from text-based material instead.","url":"/2021/10/13/dapp-ethereum-smart-contract/","mainEntityOfPage":{"@type":"WebPage","@id":"/2021/10/13/dapp-ethereum-smart-contract/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>
  <header class="texture-blue">
    <div class="container"><div class="navbar">
	<ul>
		
		<a href="/"><li  >Home</li></a>
		
		<a href="/about"><li  >About</li></a>
		
		<a href="/learn"><li  >Courses</li></a>
		
	</ul>
</div></div><div class="container">
	<h1>Creating a dApp (Smart Contract) on Ethereum</h1>
	<h4 class="post-description"></h4>
	<div class="post-date" style="margin-top:20px">
		Published on Oct 13, 2021
	</div>
	<ul class="post-tags"><li>Tutorials</li><li>Blockchains</li><li>dApps</li><li>Smart Contracts</li><li>Ethereum</li></ul>
</div>
</header>
  <main>
    <div class="container">
      <div class="post-container">
          <p>I recently created a video course on creating a dApp on top of the Ethereum framework. Along with the detailed videos, I prepared step-by-step notes for the course. So, I decided to share them here for those who wish to learn from text-based material instead.</p>

<p>If you want to get discount coupnos for my video courses (including this dApp course), head over to <a href="https://recluze.net/learn">the courses page</a>.</p>

<p>Find me on twitter <a href="http://twitter.com/recluze">@recluze</a> if you have any questions. I’d be happy to help out.</p>

<!-- more -->

<h2 id="environment-setup">Environment Setup</h2>

<p>Here’s the stuff we’ll need</p>

<ul>
  <li>NVM</li>
  <li>Node</li>
  <li>Hardhat</li>
  <li>MetaMask Wallet</li>
</ul>

<p>Set up NVM first for</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-o-</span> https://raw.githubusercontent.com/nvm-sh/nvm/v0.38.0/install.sh | bash
</code></pre></div></div>

<p>Add the environment variables for accesing node commands.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nvm <span class="nb">install</span> <span class="nt">--lts</span>
</code></pre></div></div>

<h2 id="install-metamask">Install MetaMask</h2>

<p>MetaMask will manage our wallet so that we can easily view our accounts and test our DApps easily. Go ahead and install MetaMask from <code class="language-plaintext highlighter-rouge">https://metamask.io/</code>. I’ll use Firefox but you can just as well use Chrome.</p>

<p>(I strongly suggest you use MetaMask for this tutorial so that you can follow along. There’s a million wallets out there and it would be difficult to debug issues if you use something other than MetaMask.)</p>

<p>Just go ahead and create an account on MetaMask, set your password and then save the recovery keys as given in the instructions.</p>

<h2 id="setting-up-hardhat">Setting up Hardhat</h2>

<p>In order to test out our smart contracts, we need an environment that simulates the etherium network locally. We will later try out our smart contract on a global testnet too.</p>

<p>First, set up a react app that we will use to interact with our environment.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx create-react-app react-dapp
<span class="nb">cd </span>react-dapp 
</code></pre></div></div>

<p>Now go ahead and set up hardhat along with all its dependencies. For now, let’s not go into the details of what each part does and what alternatives are available. That would only slow you down and create confusions. It’s best to get a hello world done and study options afterwards.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install </span>ethers hardhat @nomiclabs/hardhat-waffle <span class="se">\</span>
            ethereum-waffle chai <span class="se">\</span>
            @nomiclabs/hardhat-ethers
</code></pre></div></div>

<p>Let’s create basic hardhat configs and setup.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx hardhat 
</code></pre></div></div>

<p>Accept all defaults. This will create a basic sample project for us.</p>

<p>We need to edit the hardhat config file so that this works well with MetaMask. ChainId is a unique identifier for the blockchain.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vi hardhat.config.js
</code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">solidity</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.8.4</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">paths</span><span class="p">:</span> <span class="p">{</span>                         <span class="c1">// add this </span>
    <span class="na">artifacts</span><span class="p">:</span> <span class="dl">'</span><span class="s1">./src/artifacts</span><span class="dl">'</span><span class="p">,</span>  <span class="c1">// this is where our compiled contracts will go</span>
  <span class="p">},</span>
  <span class="na">networks</span><span class="p">:</span> <span class="p">{</span>                      <span class="c1">// and this ... </span>
    <span class="na">hardhat</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">chainId</span><span class="p">:</span> <span class="mi">1337</span>                <span class="c1">// this is needed for MetaMask</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Start a node using:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx hardhat node 
</code></pre></div></div>

<p>And try to connect to it using MetaMask.</p>

<h2 id="smart-contract">Smart Contract</h2>

<p>Once we have the environment set up, we actually need to create a basic contract. The hello world for DApps is a greeter contract that does both reading and writing to the chain.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//SPDX-License-Identifier: MIT</span>
<span class="nx">pragma</span> <span class="nx">solidity</span> <span class="o">^</span><span class="mf">0.8</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>

<span class="k">import</span> <span class="dl">"</span><span class="s2">hardhat/console.sol</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">contract</span> <span class="nx">Greeter</span> <span class="p">{</span>
  <span class="nx">string</span> <span class="nx">greeting</span><span class="p">;</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="nx">string</span> <span class="nx">memory</span> <span class="nx">_greeting</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Deploying a Greeter with greeting:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">_greeting</span><span class="p">);</span>
    <span class="nx">greeting</span> <span class="o">=</span> <span class="nx">_greeting</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">greet</span><span class="p">()</span> <span class="kr">public</span> <span class="nx">view</span> <span class="nx">returns</span> <span class="p">(</span><span class="nx">string</span> <span class="nx">memory</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">greeting</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">setGreeting</span><span class="p">(</span><span class="nx">string</span> <span class="nx">memory</span> <span class="nx">_greeting</span><span class="p">)</span> <span class="kr">public</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Changing greeting from '%s' to '%s'</span><span class="dl">"</span><span class="p">,</span> <span class="nx">greeting</span><span class="p">,</span> <span class="nx">_greeting</span><span class="p">);</span>
    <span class="nx">greeting</span> <span class="o">=</span> <span class="nx">_greeting</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Our contract is in solidity. This cannot be accessed directly from our Javascript frameworks. For that, we need to “compile” it to Javscript (ABI). Think of this as a wrapper that connects to the contract and can help you call functions of the contract without having to worry about the details (marshalling etc.) yourself.</p>

<p>The actual command is pretty simple:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx hardhat compile
</code></pre></div></div>

<p>A new file will be created in:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>src/artifacts/contracts/Greeter.sol/Greeter.json
</code></pre></div></div>

<p>We will import this file when writing our react script.</p>

<h2 id="starting-a-dummy-network-and-deploying-the-contract">Starting a Dummy Network and Deploying the Contract</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx hardhat node
</code></pre></div></div>

<p>These are test accounts created for the purpose of testing the local network. We’ll use these for a while. Make sure you don’t use them on actual Mainnet or even the public testnets.</p>

<p>Take note of the private key and address of the first test account.</p>

<p>Let’s go ahead and import these to our MetaMask Wallet.</p>

<p>First, connect to the localhost network. To do this, click on the <code class="language-plaintext highlighter-rouge">Network</code> dropdown (top mid) of MetaMask and select <code class="language-plaintext highlighter-rouge">localhost</code>. Rest of the configurations are fine.</p>

<p>Then, <code class="language-plaintext highlighter-rouge">Account -&gt; Import Account</code>. Then paste your private key (for first test account) in there. You should have 10,000 ETH in there. They’re not too useful though so don’t get excited. Let’s call this <code class="language-plaintext highlighter-rouge">hh-test0x</code> account.</p>

<p>Let’s create a new account outside of Hardhat and send it some Ether.</p>

<p>Go to Metamask and <code class="language-plaintext highlighter-rouge">Account -&gt; Create Account</code>. Give it a useful name. I’m using <code class="language-plaintext highlighter-rouge">recly-test0x</code>. Keep this account safe for now. We’ll be using it later on. Save the private key by going to <code class="language-plaintext highlighter-rouge">...</code> menu (the dots menu), then <code class="language-plaintext highlighter-rouge">Account Details</code>. Click on <code class="language-plaintext highlighter-rouge">Export Private Key</code>. Enter the password for MetaMask and save your private key somewhere. All of these are test keys and should defnitely not be used on mainnet.</p>

<p>Switch to <code class="language-plaintext highlighter-rouge">hh-test0x</code> account and send some ether to <code class="language-plaintext highlighter-rouge">recly-test0x</code>. (When you do this again the next time you start this tutorial from scratch, you will get a nonce error. For that, simply go to <code class="language-plaintext highlighter-rouge">Accounts -&gt; Settings -&gt; Advanced -&gt; Reset Account</code>.)</p>

<p>Note the output in console as well as ether changes in your MetaMask accounts.</p>

<h2 id="deploying-the-greeter-smart-contract">Deploying the Greeter Smart Contract</h2>

<p>A deploy script is created for you by Hardhat automatically. Just change it to a more meaningful name.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mv </span>scripts/sample-script.js scripts/deploy.js
</code></pre></div></div>

<p>Take a look at the script and then go ahead and deploy the contract. Since this is a hello world, there isn’t anything we need to change.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx hardhat run scripts/deploy.js <span class="nt">--network</span> localhost
</code></pre></div></div>

<p>We will get an output that tells us the address (or ID) of this contract.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Greeter deployed to: 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
</code></pre></div></div>

<p>Keep track of this address. We’ll need it to interact with our contract.</p>

<h2 id="accessing-from-react-app">Accessing from React App</h2>

<p>Use the following basic code to access the contract. We’ll discuss the code in detail but for now, just put the following content in <code class="language-plaintext highlighter-rouge">src/App.js</code> file.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="dl">'</span><span class="s1">./App.css</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">useState</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ethers</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">ethers</span><span class="dl">'</span>   <span class="c1">// acts like a backend for our Web3/DApp </span>
<span class="k">import</span> <span class="nx">Greeter</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./artifacts/contracts/Greeter.sol/Greeter.json</span><span class="dl">'</span>

<span class="c1">// Update with the contract address logged out to the CLI when it was deployed </span>
<span class="c1">// !!!!!!!! Change this ..... </span>
<span class="kd">const</span> <span class="nx">greeterAddress</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">0x5FbDB2315678afecb367f032d93F642f64180aa3</span><span class="dl">"</span>

<span class="kd">function</span> <span class="nx">App</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// store greeting in local state of react. Has nothing to do with the smart contract at the moment</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">greeting</span><span class="p">,</span> <span class="nx">setGreetingValue</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">()</span>

  <span class="c1">// request access to the user's account. This works regardless of the wallet you're using. </span>
  <span class="k">async</span> <span class="kd">function</span> <span class="nx">requestAccount</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">await</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ethereum</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span> <span class="na">method</span><span class="p">:</span> <span class="dl">'</span><span class="s1">eth_requestAccounts</span><span class="dl">'</span> <span class="p">});</span>
  <span class="p">}</span>

  <span class="c1">// call the smart contract, read the current greeting value</span>
  <span class="k">async</span> <span class="kd">function</span> <span class="nx">fetchGreeting</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ethereum</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">undefined</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">provider</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">providers</span><span class="p">.</span><span class="nx">Web3Provider</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">ethereum</span><span class="p">)</span>
      <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">Contract</span><span class="p">(</span><span class="nx">greeterAddress</span><span class="p">,</span> <span class="nx">Greeter</span><span class="p">.</span><span class="nx">abi</span><span class="p">,</span> <span class="nx">provider</span><span class="p">)</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">greet</span><span class="p">()</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">data: </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Error: </span><span class="dl">"</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">}</span>    
  <span class="p">}</span>

  <span class="c1">// call the smart contract, send an update</span>
  <span class="k">async</span> <span class="kd">function</span> <span class="nx">setGreeting</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">greeting</span><span class="p">)</span> <span class="k">return</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ethereum</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">undefined</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">await</span> <span class="nx">requestAccount</span><span class="p">()</span>
      <span class="kd">const</span> <span class="nx">provider</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">providers</span><span class="p">.</span><span class="nx">Web3Provider</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">ethereum</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">signer</span> <span class="o">=</span> <span class="nx">provider</span><span class="p">.</span><span class="nx">getSigner</span><span class="p">()</span>
      <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">Contract</span><span class="p">(</span><span class="nx">greeterAddress</span><span class="p">,</span> <span class="nx">Greeter</span><span class="p">.</span><span class="nx">abi</span><span class="p">,</span> <span class="nx">signer</span><span class="p">)</span>
      <span class="kd">const</span> <span class="nx">transaction</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">setGreeting</span><span class="p">(</span><span class="nx">greeting</span><span class="p">)</span>
      <span class="k">await</span> <span class="nx">transaction</span><span class="p">.</span><span class="nx">wait</span><span class="p">()</span>
      <span class="nx">fetchGreeting</span><span class="p">()</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="dl">"</span><span class="s2">App</span><span class="dl">"</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">header</span> <span class="nx">className</span><span class="o">=</span><span class="dl">"</span><span class="s2">App-header</span><span class="dl">"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">fetchGreeting</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Fetch</span> <span class="nx">Greeting</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">setGreeting</span><span class="p">}</span><span class="o">&gt;</span><span class="nb">Set</span> <span class="nx">Greeting</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">setGreetingValue</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span> <span class="nx">placeholder</span><span class="o">=</span><span class="dl">"</span><span class="s2">Set greeting</span><span class="dl">"</span> <span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="sr">/header</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">App</span><span class="p">;</span>
</code></pre></div></div>

<p>Go ahead and start the npm test server on your local machine. This will let us interact with out contract through a web frontend.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm start
</code></pre></div></div>

<p>The app should open in your browser.</p>

<p>Open Developer console and then click on the <code class="language-plaintext highlighter-rouge">Get Greeting</code> button. Take a look at the console where hardhat will output transaction/read details for you.</p>

<p>Then, enter some text in the textbox and click on <code class="language-plaintext highlighter-rouge">Set Greeting</code>. You should get a popup in MetaMask asking you to select an account. Select the account you have balance in and connect. MetaMask will show you the gas required to run this transaction. Click ahead to run the transaction.</p>

<p>See the console for hardhat that looks like this:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>eth_sendRawTransaction
  Contract call:       Greeter#setGreeting
  Transaction:         0xf69ac559e520e58f5e647820a3a14cbd1f18861a8bc1b71911dfbb2da8e33a78
  From:                0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266
  To:                  0x5fbdb2315678afecb367f032d93f642f64180aa3
  Value:               0 ETH
  Gas used:            35330 of 35606
  Block <span class="c">#2:            0x098e048300fe12ae0812dd7c067bd274bd848481f57bcbbd94153f0b3b366636</span>

  console.log:
    Changing greeting from <span class="s1">'Hello, Hardhat!'</span> to <span class="s1">'New Greeting!'</span>
</code></pre></div></div>

<p>Again, if you are re-doing the tutorial, reset the account in MetaMask to get rid of the stale state information in MetaMask.</p>

<h2 id="lets-mint-a-new-token">Let’s Mint a New Token</h2>

<p>In this section, we are going to create a new Token called <code class="language-plaintext highlighter-rouge">REC</code>. This will be a subcurrency and will showcase reads and writes to the etherium blockchain.</p>

<p>First, create a new contract by pasting the following code in <code class="language-plaintext highlighter-rouge">contracts/Token.sol</code>:</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//SPDX-License-Identifier: MIT
</span><span class="k">pragma</span> <span class="n">solidity</span> <span class="o">^</span><span class="mf">0.8</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>

<span class="k">import</span> <span class="s">"hardhat/console.sol"</span><span class="p">;</span>

<span class="k">contract</span> <span class="n">Token</span> <span class="p">{</span>
  <span class="kt">string</span> <span class="k">public</span> <span class="n">name</span> <span class="o">=</span> <span class="s">"Recluze Token"</span><span class="p">;</span>
  <span class="kt">string</span> <span class="k">public</span> <span class="n">symbol</span> <span class="o">=</span> <span class="s">"REC"</span><span class="p">;</span>
  <span class="kt">uint</span> <span class="k">public</span> <span class="n">totalSupply</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span>

  <span class="k">mapping</span><span class="p">(</span><span class="kt">address</span> <span class="o">=&gt;</span> <span class="kt">uint</span><span class="p">)</span> <span class="n">balances</span><span class="p">;</span>

  <span class="k">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">balances</span><span class="p">[</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">]</span> <span class="o">=</span> <span class="n">totalSupply</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">function</span> <span class="nb">transfer</span><span class="p">(</span><span class="kt">address</span> <span class="n">to</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">amount</span><span class="p">)</span> <span class="k">external</span> <span class="p">{</span>
    <span class="nb">require</span><span class="p">(</span><span class="n">balances</span><span class="p">[</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">amount</span><span class="p">,</span> <span class="s">"Insufficient tokens"</span><span class="p">);</span>
    <span class="n">balances</span><span class="p">[</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">]</span> <span class="o">-=</span> <span class="n">amount</span><span class="p">;</span>
    <span class="n">balances</span><span class="p">[</span><span class="n">to</span><span class="p">]</span> <span class="o">+=</span> <span class="n">amount</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">function</span> <span class="n">balanceOf</span><span class="p">(</span><span class="kt">address</span> <span class="n">account</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">balances</span><span class="p">[</span><span class="n">account</span><span class="p">];</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Compile the contract as before.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx hardhat compile 
</code></pre></div></div>

<p>Make the needed changes in <code class="language-plaintext highlighter-rouge">scripts/deploy.js</code> so that this contract is also deployed alongside the greeter.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// in function main, add the following </span>
<span class="kd">const</span> <span class="nx">Token</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Token</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Token</span><span class="p">.</span><span class="nx">deploy</span><span class="p">();</span>
<span class="k">await</span> <span class="nx">token</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Token deployed to:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">token</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>
</code></pre></div></div>

<p>Then let’s deploy it.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx hardhat run scripts/deploy.js <span class="nt">--network</span> localhost
</code></pre></div></div>

<p>Take note of the token address. We’ll need it.</p>

<p>Go to MetaMask and click on <code class="language-plaintext highlighter-rouge">Import Token</code> in the main window. Paste the address of the token we just created. Set <code class="language-plaintext highlighter-rouge">Decimal</code> to 0 if needed. Now you should have the REC token added with the amount properly set.</p>

<p>You can transfer REC token to another account as you can ETH. Of course, you’ll need ETH for gas during transaction writing. Go ahead and transfer some RECs to <code class="language-plaintext highlighter-rouge">recly-test0x</code> account.</p>

<h2 id="sending-and-receiving-tokens-using-web-frontend">Sending and Receiving Tokens using Web Frontend</h2>

<p>Add the following two functions to <code class="language-plaintext highlighter-rouge">src/App.js</code>.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ... </span>

<span class="k">import</span> <span class="nx">Token</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./artifacts/contracts/Token.sol/Token.json</span><span class="dl">'</span>
<span class="c1">// ... </span>

<span class="kd">const</span> <span class="nx">tokenAddress</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">0x5FC8d32690cc91D4c39d9d3abcBD16989F875707</span><span class="dl">"</span>   <span class="c1">// !!! Change this</span>
<span class="c1">// ... </span>

<span class="c1">// Within App() </span>

<span class="kd">const</span> <span class="p">[</span><span class="nx">userAccount</span><span class="p">,</span> <span class="nx">setUserAccount</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">()</span>
<span class="kd">const</span> <span class="p">[</span><span class="nx">amount</span><span class="p">,</span> <span class="nx">setAmount</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">()</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">getBalance</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ethereum</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">undefined</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="p">[</span><span class="nx">account</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ethereum</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span> <span class="na">method</span><span class="p">:</span> <span class="dl">'</span><span class="s1">eth_requestAccounts</span><span class="dl">'</span> <span class="p">})</span>
      <span class="kd">const</span> <span class="nx">provider</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">providers</span><span class="p">.</span><span class="nx">Web3Provider</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">ethereum</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">Contract</span><span class="p">(</span><span class="nx">tokenAddress</span><span class="p">,</span> <span class="nx">Token</span><span class="p">.</span><span class="nx">abi</span><span class="p">,</span> <span class="nx">provider</span><span class="p">)</span>
      <span class="kd">const</span> <span class="nx">balance</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">balanceOf</span><span class="p">(</span><span class="nx">account</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Balance: </span><span class="dl">"</span><span class="p">,</span> <span class="nx">balance</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
    <span class="p">}</span>
  <span class="p">}</span>

<span class="c1">// ... </span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">sendCoins</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ethereum</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">undefined</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">await</span> <span class="nx">requestAccount</span><span class="p">()</span>
      <span class="kd">const</span> <span class="nx">provider</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">providers</span><span class="p">.</span><span class="nx">Web3Provider</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">ethereum</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">signer</span> <span class="o">=</span> <span class="nx">provider</span><span class="p">.</span><span class="nx">getSigner</span><span class="p">();</span>
      <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">Contract</span><span class="p">(</span><span class="nx">tokenAddress</span><span class="p">,</span> <span class="nx">Token</span><span class="p">.</span><span class="nx">abi</span><span class="p">,</span> <span class="nx">signer</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">transation</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">transfer</span><span class="p">(</span><span class="nx">userAccount</span><span class="p">,</span> <span class="nx">amount</span><span class="p">);</span>
      <span class="k">await</span> <span class="nx">transation</span><span class="p">.</span><span class="nx">wait</span><span class="p">();</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">amount</span><span class="p">}</span><span class="s2"> Coins successfully sent to </span><span class="p">${</span><span class="nx">userAccount</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

<span class="c1">// ...</span>

</code></pre></div></div>

<p>Also add the following in the React template in the same file:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">onClick=</span><span class="s">{getBalance}</span><span class="nt">&gt;</span>Get Balance<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">onClick=</span><span class="s">{sendCoins}</span><span class="nt">&gt;</span>Send Coins<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">onChange=</span><span class="s">{e</span> <span class="err">=</span><span class="nt">&gt;</span> setUserAccount(e.target.value)} placeholder="Account ID" /&gt;
  <span class="nt">&lt;input</span> <span class="na">onChange=</span><span class="s">{e</span> <span class="err">=</span><span class="nt">&gt;</span> setAmount(e.target.value)} placeholder="Amount" /&gt;
</code></pre></div></div>

<p>Start the npm server again.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm start 
</code></pre></div></div>

<p>In the server, click on <code class="language-plaintext highlighter-rouge">Get Balance</code> to get the REC balance. Copy the Account ID of <code class="language-plaintext highlighter-rouge">recly-test0x</code> and send 20 REC to that account. MetaMask will ask you to connect your account if it’s been a while. You can now go ahead and send the REC. Check the balance again on both accounts to ensure RECs have been transferred.</p>

<h2 id="deploying-on-the-publicglobal-ropsten-network">Deploying on the Public/Global Ropsten Network</h2>

<p>Now let’s do the same with the online Ropsten Testnet because we actually want to have this app distributed! It is supposed to be a DApp after all!</p>

<h3 id="get-some-fake-ether-on-the-testnet">Get Some Fake Ether on the Testnet</h3>

<p>The very first thing you need to do is get some ETH in your account. For this you need to use a <code class="language-plaintext highlighter-rouge">faucet</code>. These are available for free and can be found by searching for <code class="language-plaintext highlighter-rouge">"ropsten faucet"</code>. At the moment, the following faucets work:</p>

<ul>
  <li>https://faucet.ropsten.be/</li>
  <li>https://faucet.metamask.io/</li>
  <li>https://faucet.dimensions.network/</li>
</ul>

<p>Request ETH on all the faucets. You’ll need it for testing and it sometimes takes time to receive it. Make sure you give it an address that you created yourself. Hardhat accounts are publicly known and people will steal your (fake) ether from the testnet and you won’t be able to test out your contracts.</p>

<h3 id="get-endpoints">Get Endpoints</h3>

<p>Next, let’s create a project in Infura. This will give us an endpoint through which we can actually push our contract. Think of this as the equivalent of the <code class="language-plaintext highlighter-rouge">node</code> that we created locally. For the internet, you need some node to act on your behalf. We’ll use infura but you can also use Alchemy.</p>

<p>Go to <code class="language-plaintext highlighter-rouge">infura.io</code> and create a new Etherium project. You need the <code class="language-plaintext highlighter-rouge">Project ID</code>. Also select Ropsten from the Endpoints dropdown and get the endpoint URL. Save both of these somewhere.</p>

<p>Also in the security tab, enter your public key (not the private key!) for the account <code class="language-plaintext highlighter-rouge">recly-test0x</code> account. This is because we have some test ETH in this account and we’ll need that to deploy our contracts.</p>

<p>Stop the hardhat node and let’s configure it to use the Ropsten Testnet.</p>

<p>Edit the <code class="language-plaintext highlighter-rouge">hardhat.config.js</code> file and add the configs for Ropsten.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">networks</span><span class="p">:</span> <span class="p">{</span>                   <span class="c1">// and this ...</span>
  <span class="nl">hardhat</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">chainId</span><span class="p">:</span> <span class="mi">1337</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="nx">ropsten</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://ropsten.infura.io/v3/e5143812e60d4048a480d4fde5??????</span><span class="dl">"</span><span class="p">,</span>  <span class="c1">// Ropsten endpoint </span>
    <span class="nx">accounts</span><span class="p">:</span> <span class="p">[</span>
      <span class="dl">"</span><span class="s2">0x261e20914b939aec2aa0529c115c8970dfa949e021bb6b0f3bef40faad??????</span><span class="dl">"</span> <span class="c1">// private key with ETH</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx hardhat run scripts/deploy.js <span class="nt">--network</span> ropsten 
</code></pre></div></div>

<p>This will use up your ETH, which you can verify through MetaMask. Go to dots menu for <code class="language-plaintext highlighter-rouge">recly-test0x</code> account and click on <code class="language-plaintext highlighter-rouge">View on Etherscan</code>.</p>

<p>You can now go ahead and import the REC token which is now on the Ropsten Testnet but is an actual DApp!</p>

<p>Congrats!</p>

<h2 id="deploying-on-mainnet">Deploying on Mainnet</h2>

<p>Deploying on mainnet is exactly the same as with Ropsten. You can get an endpoint for mainnet from Infura. The difference is only that you will need real ETH to deploy your DApp on mainnet and it would take gas to write transactions to the block.</p>

<p>So, test well on the testnets and only move to mainnet when you are sure everything is fine.</p>

<p>Good luck!</p>

      </div>

        <!-- Configure Disqus --></div>
  </main><footer class="footer">
  <span class="text-muted"> recluze | No rights reserved.</span>
</footer>
</body>
</html>